
## 什么是redis
 redis是一个开源的高性能KV非关系型数据库，支持存储value相对较多
## redis优点
- 读写性能好
- 支持数据持久化 AOF和RDB
- 支持事务，所有操作都是原子性要么全部成功，要么全部失败
- 数据结构丰富
- 支持主从赋值，可以进行读写分离
- 丰富的特新，可以用于缓存，设置key的过期时间，过期后会自动删除

## 为什么要用缓存
- 高性能：每个请求都访问数据库的话会有大量的IO操作，IO相对于内存的读写效率慢的多
- 高并发：大并发情况下如果都用IO查询，会造成数据库压力剧增，使用缓存可以减少直接访问库的压力
## 为什么使用redis，而不是用本地缓存
- map和guava使用的都是本地缓存，生命周期跟随JVM的活动来生存，与进程共用内存，每个进程各自保存一份，占用空间多，还有可能由各个进行数据不一致的情况
- 使用redis等分布式缓存框架，所有服务公用一份缓存数据，数据有一致性，并且redis可以保证高可用。
## redis为什么那么快
- 完全基于内存，绝大部分都是内存操作
- 数据结构简单
- 采用单线程，避免了线程的上下文切换，不用考虑锁相关的内容
- 使用IO多路复用模型，非阻塞IO

## reids数据类型

| 数据类型   | 存储的值   | 应用场景                 |
| ------ | ------ | -------------------- |
| string | 字符串，数字 | 简单的kv存储              |
| list   | 列表     | 存储列表型数据结构，粉丝列表，评论列表等 |
| set    | 无序集合   | 交集并集差集等操作，比如公共好友等    |
| hash   | 键值对    | 结构化对象                |
| zset   | 有序集合   | 根据权重进行排名，比如某个前几名用户   |


## redis应用场景
- 计数器：利用string的自增自减运算
- 缓存：热点数据，利用淘汰策略保证缓存命中率
- 会话缓存：
- 消息队列
- 分布式锁：
	- 使用redis自带的setnx命令实现的分布式锁
	- redlock实现的分布式锁
## RDB
- 是redis默认的持久化方式，将redis中数据形成一个dump文件，
- 优点
	- 只有一个文件
	- 容灾性好
	- 回复性能高
- 缺点：
	- 数据安全型低，每隔一段时间（1分钟 10000个key被修改）才会触发持久化，容易丢失数据
	- dump文件可读性不好
## AOF
- 是将redis执行的命令写到单独的文件中，重启时会根据命令进行恢复
- rdb和aof同时开启时，redis优先使用aof进行恢复
- 优点
	- aof通过配置，每进行一次操作就会记录到文件中
	- rewrite命令可以在文件过大时，精简一些命令，仅保留最终恢复后保持一致的命令
- 缺点：
	- aof文件大，恢复效率慢
	- 重启时比rdb启动效率低

## aof和rdb对比优缺点
- aof文件更新频率高，优先使用aof进行恢复
- aof文件比rdb安全
- rdb性能比aof高

## 如何选择持久化方式
- 如果能接收分钟内的数据丢失，可以仅使用RDB持久化方式
- 建议同时使用两种持久化方式

